# 单片机

[toc]
## 原理部分



## 程序部分

### 1 汇编语言

### 2 C语言

#### 01 常用头文件

1. 函数库头文件

```
1. 包含51单片机特有的寄存器定义和函数宏等；
#include<reg51.h>

2. 包含一些与51单片机相关的内嵌函数，如_nop()和_crol_()等；
#include "intrins.h"

```

2. 定义数据类型头文件

```
1. 定义无符号字符串
# 取值范围是0到255
#define uchar unsigned char

2. 定义符号字符串
# 取值范围通常为-128到127
#define char signed char

3. 定义无符号整型
# 取值范围为0到4294967295（2^32-1）。
#define uint unsigned int

4. 定义符号整形
# 取值范围-2,147,483,648到2,147,483,647（即-2^31到2^31-1）
#define int signed int

5. 定义输出端口
#define out P1 

6. 定义标识符
# 它的作用是将标识符TICK替换为10000。在代码中，可以使用TICK代替10000，提高代码的可读性和可维护性。
#define TICK 10000
# 它的作用是将标识符T100us替换为256-100。在代码中，可以使用T100us代替256-100，提高代码的可读性和可维护性。
#define T100us	256-100
```

#### 02 代码正文

1. 定义引脚

   ```
   sbit led=P2^0;
   # 这段单片机代码定义了一个 sbit 类型的变量 led，用于控制单片机的一个引脚。其中，sbit 是 Keil C51 编译器提供的一种关键字，表示声明一个特殊功能寄存器位（Special Function Register Bit）。
   led 变量表示了单片机的 P2 口第 0 位引脚，即通过该变量可以控制单片机的 P2.0 引脚的输入输出。这个引脚可以连接到 LED 灯等输出设备，以控制其亮灭状态。
   ```

2. 定义数据类型

   ```
   uint C100us;
   # C100us为无符号整型
   ```

3. 定义定时器/计数器工作模式

```
TMOD=0X02;
# 在单片机中，TMOD寄存器控制着定时器/计数器的工作模式。在这里，代码将TMOD寄存器的值设置为0x02，即二进制的00000010。这表示将定时器1设置为8位自动重装载计数器模式，每个计数需要12个时钟周期。这通常用于生成短时间延迟或产生周期性的时间间隔。
```

4. 定义定时器/计数器的初值

   ```
   TH0=T100us;
   TL0=T100us;
   # 在单片机的定时器计数器中，TH0和TL0分别表示定时器计数器的高8位和低8位，T100us是一个预定义的宏，代表定时器每次计数100微秒。这两行代码的作用是将定时器计数器的初值设为T100us，即每次计数100微秒。由于定时器工作时是从计数器初值开始计数的，因此这两行代码是设定定时器的初始计数值。
   ```

5. 定义中断情况

   ```
   IE=0X92;
   TR0=1;
   # IE=0x92; 是设置中断控制寄存器（Interrupt Enable Register）的值为0x92，即打开定时器0中断和串口中断。
   # TR0=1; 是开启定时器0计数器。如果打开定时器1计数器：TR1=1
   
   # IE寄存器的具体值含义为
   打开全局中断开关
   EA=1
   ET2=0: 关闭定时器2中断
   ES=1: 打开串口中断
   ET1=0: 关闭定时器1中断
   EX1=0: 关闭外部中断1
   ET0=1: 打开定时器0中断
   EX0=0: 关闭外部中断0
   ```

   

